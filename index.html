<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VAZapp</title>
<link rel="manifest" href="data:application/json,{\"name\":\"VAZapp\",\"short_name\":\"VAZapp\",\"start_url\":\".\",\"display\":\"standalone\",\"background_color\":\"#000000\",\"theme_color\":\"#0a84ff\"}">
<style>
body{margin:0;font-family:Arial;background:#000;color:#fff}
header{padding:10px;background:#111;text-align:center;font-size:20px;font-weight:bold}
#storiesBar{display:flex;overflow-x:auto;padding:10px;background:#111;gap:10px}
.storyBubble{min-width:70px;text-align:center;cursor:pointer}
.storyBubble img{width:60px;height:60px;border-radius:50%;border:2px solid #0a84ff;object-fit:cover}
#feed{padding:10px}
.post{background:#111;margin-bottom:15px;border-radius:10px;overflow:hidden}
.postHeader{padding:8px;font-weight:bold}
.postMedia img,.postMedia video{width:100%;max-height:400px;object-fit:contain;background:#000}
.postCaption{padding:8px;color:#ccc}
#newStory{position:fixed;bottom:0;left:0;right:0;background:#111;padding:10px;display:flex;gap:5px}
#newStory input{flex:1}
#storyViewer{position:fixed;inset:0;background:rgba(0,0,0,0.95);display:none;align-items:center;justify-content:center;flex-direction:column;z-index:99}
#storyViewer img,#storyViewer video{max-width:90%;max-height:80%}
#closeStory{margin-top:10px;padding:6px 12px}
</style>
</head>
<body>
<header>VAZapp</header>

<div id="storiesBar"></div>
<div id="feed"></div>

<div id="newStory">
<input type="file" id="storyFile" accept="image/*,video/*">
<input type="text" id="storyCaption" placeholder="Your story caption">
<button onclick="addUserStory()">Post</button>
</div>

<div id="storyViewer">
<div id="storyContent"></div>
<button id="closeStory" onclick="closeStory()">Close</button>
</div>

<script>
// ---------------- DATA ----------------
let fakeUsers=[
{
 name:"ConnorMcDavid",
 avatar:"mcdavid.png",
 story:{
  type:"image",
  src:"mcdavid.png",
  caption:"Connor McDavid scores 2 goals vs Flames"
 }
},
{
 name:"MapleLeafs",
 avatar:"leafs.gif",
 story:{
  type:"gif",
  src:"leafs.gif",
  caption:"Maple Leafs win overtime vs Bruins"
 }
},
{
 name:"NYRangers",
 avatar:"rangers.gif",
 story:{
  type:"gif",
  src:"rangers.gif",
  caption:"Rangers celebrate playoff spot at MSG"
 }
}
];

let userStories=JSON.parse(localStorage.getItem("userStories")||"[]");

// ---------------- STORIES ----------------
function cleanExpired(){
 const now=Date.now();
 userStories=userStories.filter(s=>now-s.time<24*60*60*1000);
 localStorage.setItem("userStories",JSON.stringify(userStories));
}

function renderStories(){
 cleanExpired();
 const bar=document.getElementById("storiesBar");
 bar.innerHTML="";

 fakeUsers.forEach(u=>{
  const d=document.createElement("div");
  d.className="storyBubble";
  d.innerHTML=`<img src="${u.avatar}"><div>${u.name}</div>`;
  d.onclick=()=>openStory(u.story);
  bar.appendChild(d);
 });

 userStories.forEach((s,i)=>{
  const d=document.createElement("div");
  d.className="storyBubble";
  d.innerHTML=`<img src="${s.src}"><div>You</div>`;
  d.onclick=()=>openStory(s);
  bar.appendChild(d);
 });
}

function openStory(story){
 const v=document.getElementById("storyViewer");
 const c=document.getElementById("storyContent");
 c.innerHTML="";

 if(story.type==="video"){
  const vid=document.createElement("video");
  vid.src=story.src;
  vid.autoplay=true;vid.controls=true;
  c.appendChild(vid);
 }else{
  const img=document.createElement("img");
  img.src=story.src;
  c.appendChild(img);
 }

 const cap=document.createElement("div");
 cap.style.marginTop="10px";
 cap.innerText=story.caption||"";
 c.appendChild(cap);

 v.style.display="flex";
}

function closeStory(){
 document.getElementById("storyViewer").style.display="none";
}

// ---------------- USER STORIES ----------------
function addUserStory(){
 const file=document.getElementById("storyFile").files[0];
 const cap=document.getElementById("storyCaption").value;
 if(!file)return alert("Select a file");

 const reader=new FileReader();
 reader.onload=()=>{
  userStories.push({
   type:file.type.startsWith("video")?"video":"image",
   src:reader.result,
   caption:cap,
   time:Date.now()
  });

  localStorage.setItem("userStories",JSON.stringify(userStories));
  renderStories();
 };
 reader.readAsDataURL(file);
}

// ---------------- FEED ----------------
function renderFeed(){
 const feed=document.getElementById("feed");
 feed.innerHTML="";

 fakeUsers.forEach(u=>{
  const p=document.createElement("div");
  p.className="post";

  p.innerHTML=`
   <div class="postHeader">${u.name}</div>
   <div class="postMedia">${
    u.story.type==="video"
    ?`<video src="${u.story.src}" controls></video>`
    :`<img src="${u.story.src}">`
   }</div>
   <div class="postCaption">${u.story.caption}</div>
  `;

  feed.appendChild(p);
 });
}

// ---------------- INIT ----------------
renderStories();
renderFeed();

// PWA
if("serviceWorker" in navigator){
 const sw=`self.addEventListener('fetch',e=>{});`;
 const blob=new Blob([sw],{type:"text/javascript"});
 const url=URL.createObjectURL(blob);
 navigator.serviceWorker.register(url);
}
</script>

<!--
IMPORTANT:
Place these files in the same folder as this HTML:
1) mcdavid.png  (McDavid vs Flames image)
2) leafs.gif    (Leafs OT vs Bruins gif)
3) rangers.gif  (Rangers celebration gif)
-->

</body>
</html>
