<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VAZapp</title>
<script src="https://cdn.tailwindcss.com"></script>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">

<style>
body{font-family:Arial,sans-serif;transition:.3s}
.dark{background:#111827;color:#fff}
.dark .bg-white{background:#1f2933!important;color:#fff}

@keyframes auraGlow{
0%,100%{text-shadow:0 0 5px #0ff,0 0 15px #0ff}
50%{text-shadow:0 0 25px #0ff,0 0 40px #0ff}
}

.logo-animation{
position:fixed;inset:0;display:flex;justify-content:center;align-items:center;
background:#000;z-index:9999;font-size:3rem;font-weight:bold;transition:opacity 1s ease;
}
.logo-animation .highlight{color:#0ff;animation:auraGlow 1.5s infinite}
.logo-animation .app{color:#fff;font-weight:900}
</style>
</head>
<body id="body" class="bg-gray-100 min-h-screen flex flex-col">

<!-- Splash -->
<div id="logoAnimation" class="logo-animation">
<span><span class="highlight">VAZ</span><span class="app">app</span></span>
</div>

<!-- Header -->
<header class="bg-blue-600 text-white p-4 flex justify-between items-center">
<h1 class="font-bold text-xl">VAZapp</h1>
<div class="space-x-2 flex items-center">
<button onclick="showChat()" class="bg-blue-500 px-3 py-1 rounded">Chat</button>
<button onclick="showStories()" class="bg-blue-500 px-3 py-1 rounded">Stories</button>
<button onclick="showProfile()" class="bg-blue-500 px-3 py-1 rounded">Profile</button>
<button onclick="toggleDark()" class="bg-gray-800 px-3 py-1 rounded">üåô</button>
<button id="installBtn" class="bg-green-500 px-3 py-1 rounded hidden">Install</button>
</div>
</header>

<main class="flex-1 p-4 flex justify-center items-start">
<!-- Chat -->
<div id="chatPage" class="bg-white w-full max-w-xl p-4 rounded shadow flex flex-col">
<div class="flex items-center gap-2 mb-2">
<img id="chatAvatar" class="w-8 h-8 rounded-full" src="https://via.placeholder.com/40">
<span id="chatName" class="font-bold">Guest</span>
</div>
<div id="chat" class="flex-1 border p-2 rounded mb-2 overflow-y-auto"></div>
<div class="flex gap-2">
<input id="userInput" class="flex-1 border p-2 rounded text-black dark:text-white bg-white dark:bg-gray-700" placeholder="Type...">
<button onclick="sendMessage()" class="bg-blue-600 text-white px-3 rounded">Send</button>
</div>
</div>

<!-- Stories -->
<div id="storiesPage" class="hidden bg-white w-full max-w-2xl p-4 rounded shadow">
<h2 class="text-xl font-bold mb-2">üì∏ Stories</h2>
<input type="file" accept="image/*,video/*" onchange="uploadStory(event)" class="mb-3">
<div id="storiesFeed" class="space-y-4"></div>
</div>

<!-- Profile -->
<div id="profilePage" class="hidden bg-white w-full max-w-md p-4 rounded shadow">
<h2 class="text-xl font-bold mb-3">Profile</h2>
<img id="profilePreview" class="w-24 h-24 rounded-full mx-auto mb-2" src="https://via.placeholder.com/120">
<input type="file" accept="image/*" onchange="loadImage(event)"><br><br>
<input id="usernameInput" class="border p-2 w-full mb-2" placeholder="Username">
<button onclick="saveProfile()" class="bg-blue-600 text-white w-full p-2 rounded">Save</button>
</div>
</main>

<footer class="bg-gray-200 p-2 text-center text-sm">¬©2026 VAZapp</footer>

<script>
/* ===== SPLASH ===== */
window.addEventListener("load",()=>{
  const logo=document.getElementById("logoAnimation");
  setTimeout(()=>{logo.style.opacity="0";setTimeout(()=>logo.remove(),1200);},1500);
});

/* ===== PWA INSTALL ===== */
let deferredPrompt;
const installBtn=document.getElementById("installBtn");

window.addEventListener('beforeinstallprompt', (e)=>{
  e.preventDefault();
  deferredPrompt = e;
  installBtn.classList.remove("hidden");
});

installBtn.addEventListener("click", ()=>{
  if(deferredPrompt){
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then((choiceResult)=>{
      if(choiceResult.outcome==='accepted') console.log("VAZapp installed");
      deferredPrompt=null;
      installBtn.classList.add("hidden");
    });
  }
});

/* ===== NAV ===== */
const chatPage=document.getElementById("chatPage");
const storiesPage=document.getElementById("storiesPage");
const profilePage=document.getElementById("profilePage");
function showChat(){chatPage.classList.remove("hidden");storiesPage.classList.add("hidden");profilePage.classList.add("hidden");}
function showStories(){storiesPage.classList.remove("hidden");chatPage.classList.add("hidden");profilePage.classList.add("hidden");renderStories();}
function showProfile(){profilePage.classList.remove("hidden");chatPage.classList.add("hidden");storiesPage.classList.add("hidden");}

/* ===== DARK MODE ===== */
function toggleDark(){body.classList.toggle("dark");localStorage.vaz_dark=body.classList.contains("dark");}

/* ===== PROFILE ===== */
function loadImage(e){const r=new FileReader();r.onload=()=>profilePreview.src=r.result;r.readAsDataURL(e.target.files[0]);}
function saveProfile(){localStorage.vaz_user=usernameInput.value||"Guest";localStorage.vaz_avatar=profilePreview.src;loadProfile();showChat();}
function loadProfile(){chatName.textContent=localStorage.vaz_user||"Guest";usernameInput.value=localStorage.vaz_user||"";if(localStorage.vaz_avatar){chatAvatar.src=localStorage.vaz_avatar;profilePreview.src=localStorage.vaz_avatar;}}

/* ===== CHAT ===== */
function addMsg(t,s){const d=document.createElement("div");d.className=s==="u"?"text-right text-blue-500":"text-left text-green-500";d.textContent=(s==="u"?"You: ":"vazAI: ")+t;chat.appendChild(d);chat.scrollTop=chat.scrollHeight;}
function sendMessage(){const t=userInput.value.trim();if(!t)return;addMsg(t,"u");userInput.value="";setTimeout(()=>addMsg(ai(t),"a"),600);}
userInput.onkeydown=e=>{if(e.key==="Enter")sendMessage();}
function ai(m){m=m.toLowerCase();if(/\d+[+\-*/]\d+/.test(m))return "Answer: "+eval(m);if(m.includes("weather"))return "Check your local forecast online.";if(m.includes("code"))return "Tell me what you're building.";if(m.includes("sad")||m.includes("stress"))return "I'm here for you üíô";if(m.startsWith("how"))return "Let's break it down step by step.";if(m.startsWith("what")||m.startsWith("who"))return "Good question!";return "Tell me more so I can help."}

/* ===== STORIES ===== */
let stories=JSON.parse(localStorage.vaz_stories||"[]");
let likes=JSON.parse(localStorage.vaz_likes||"{}");
let comments=JSON.parse(localStorage.vaz_comments||"{}");
let follows=JSON.parse(localStorage.vaz_follows||"[]");

const fakeUsers=[
  {user:"NHL",posts:[
    {text:"Maple Leafs celebrate win üèí",src:"https://images.unsplash.com/photo-1517649763962-0c623066013b?auto=format&fit=crop&w=900&q=80",type:"image"},
    {text:"Packed arena for playoffs",src:"https://images.unsplash.com/photo-1505842465776-3a8f84b0c84a?auto=format&fit=crop&w=900&q=80",type:"image"}
  ]},
  {user:"NBC-News",posts:[
    {text:"Severe storm hits coast",src:"https://images.unsplash.com/photo-1501594907352-04cda38ebc29?auto=format&fit=crop&w=900&q=80",type:"image"},
    {text:"Emergency summit today",src:"https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=900&q=80",type:"image"}
  ]}
];

function generateFakeStories(){
  const last=localStorage.vaz_fake_time||0; const now=Date.now();
  if(now-last>86400000){fakeUsers.forEach(f=>{const p=f.posts[Math.floor(Math.random()*f.posts.length)];
    stories.unshift({id:Date.now()+Math.random(),user:f.user,src:p.src,mediaType:p.type,text:p.text,fake:true});});
    localStorage.vaz_fake_time=now; saveStories();
  }
}
generateFakeStories();

function uploadStory(e){
  const f=e.target.files[0]; if(!f)return;
  const caption=prompt("Caption:")||"My story";
  const type=f.type.startsWith("image")?"image":"video";
  const r=new FileReader();
  r.onload=()=>{stories.unshift({id:Date.now(),user:localStorage.vaz_user||"Guest",src:r.result,mediaType:type,text:caption,fake:false});saveStories();renderStories();};
  r.readAsDataURL(f);
}

function saveStories(){localStorage.vaz_stories=JSON.stringify(stories);localStorage.vaz_likes=JSON.stringify(likes);localStorage.vaz_comments=JSON.stringify(comments);localStorage.vaz_follows=JSON.stringify(follows);}
function toggleFollow(u){follows.includes(u)?follows=follows.filter(x=>x!==u):follows.push(u);saveStories();renderStories();}
function likeStory(id){likes[id]=(likes[id]||0)+1;saveStories();renderStories();}
function addComment(id){const t=prompt("Comment:");if(!t)return;comments[id]=comments[id]||[];comments[id].push(t);saveStories();renderStories();}
function deleteStory(i){if(!confirm("Delete this story?"))return;stories.splice(i,1);saveStories();renderStories();}

function renderStories(){
  storiesFeed.innerHTML="";
  stories.forEach((s,index)=>{
    if(follows.length&&!follows.includes(s.user)&&s.user!==(localStorage.vaz_user||"Guest"))return;
    const d=document.createElement("div");d.className="border p-3 rounded";
    const followed=follows.includes(s.user);
    let content=s.mediaType==="image"?`<img src='${s.src}' class='w-full rounded mb-1'/><p class='mt-1 text-sm'>${s.text||""}</p>`:
                s.mediaType==="video"?`<video src='${s.src}' controls class='w-full rounded mb-1'></video><p class='mt-1 text-sm'>${s.text||""}</p>`:
                `<p class='mb-2 italic'>üì∞ ${s.text}</p>`;
    const canDelete = s.user === (localStorage.vaz_user || "Guest");
    d.innerHTML=`<div class='flex justify-between mb-1'><b>${s.user}</b><div class='flex gap-2'><button onclick="toggleFollow('${s.user}')" class='text-blue-600'>${followed?"Unfollow":"Follow"}</button>${canDelete?`<button onclick="deleteStory(${index})" class='text-red-600'>üóëÔ∏è</button>`:""}</div></div>${content}<div class='flex gap-3 text-sm'><button onclick="likeStory(${s.id})">‚ù§Ô∏è ${likes[s.id]||0}</button><button onclick="addComment(${s.id})">üí¨ ${comments[s.id]?comments[s.id].length:0}</button></div>`;
    storiesFeed.appendChild(d);
  });
}

/* ===== LOGIN ===== */
function login(){let u = prompt("Choose a username:", localStorage.vaz_user||"");if(!u) return;localStorage.vaz_user = u;loadProfile();}
if(!localStorage.vaz_user){setTimeout(login,500);}

/* ===== INIT ===== */
function init(){if(localStorage.vaz_dark==="true")body.classList.add("dark");loadProfile();addMsg("Hi! I'm vazAI ü§ñ","a");renderStories();}
init();
</script>
</body>
</html>
