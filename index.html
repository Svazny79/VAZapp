<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VazAI Stories</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Arial,Helvetica,sans-serif;
}

body{
  background:#000;
  color:#fff;
}

/* Story Bar */
#storyBar{
  display:flex;
  gap:12px;
  padding:12px;
  overflow-x:auto;
  background:#111;
}

.storyIcon{
  width:70px;
  height:70px;
  border-radius:50%;
  border:3px solid #ff004f;
  cursor:pointer;
  object-fit:cover;
}

/* Viewer */
#viewer{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  justify-content:center;
  align-items:center;
  z-index:1000;
}

#storyBox{
  width:100%;
  max-width:420px; /* Reels/Shorts size */
  height:100%;
  max-height:760px;
  background:#000;
  position:relative;
  overflow:hidden;
}

#storyMedia{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* Progress */
#progress{
  position:absolute;
  top:0;
  left:0;
  height:4px;
  width:0%;
  background:#ff004f;
}

/* Caption */
#caption{
  position:absolute;
  bottom:20px;
  left:10px;
  right:10px;
  background:rgba(0,0,0,0.6);
  padding:10px;
  border-radius:8px;
  font-size:14px;
}

/* Close */
#closeBtn{
  position:absolute;
  top:10px;
  right:10px;
  font-size:26px;
  cursor:pointer;
}

/* Upload */
#uploadBox{
  padding:15px;
  background:#111;
  border-top:1px solid #222;
}

#uploadBox input, #uploadBox button{
  width:100%;
  margin-top:6px;
  padding:8px;
  border:none;
  border-radius:6px;
}

#uploadBox button{
  background:#ff004f;
  color:white;
  cursor:pointer;
}
</style>
</head>
<body>

<h2 style="padding:10px">VazAI Stories</h2>

<div id="storyBar"></div>

<!-- Viewer -->
<div id="viewer">
  <div id="storyBox">
    <div id="progress"></div>
    <span id="closeBtn">âœ•</span>
    <img id="storyMedia">
    <div id="caption"></div>
  </div>
</div>

<!-- Upload -->
<div id="uploadBox">
  <h3>Add Your Story</h3>
  <input type="file" id="fileInput" accept="image/*,video/*">
  <input type="text" id="captionInput" placeholder="Write caption...">
  <button onclick="addStory()">Post</button>
</div>

<script>

let stories = [

// --- Sports / News ---
{
  user:"McDavid News",
  media:"/mnt/data/d37d499d-073e-4198-a1d4-181b2a442107.png",
  type:"image",
  caption:"Connor McDavid scores 2 goals vs Flames",
  time:Date.now()
},
{
  user:"Leafs Update",
  media:"/mnt/data/f35bf52a-2b49-4613-8150-d34272101e73.png",
  type:"gif",
  caption:"Maple Leafs win OT vs Bruins",
  time:Date.now()
},
{
  user:"Rangers News",
  media:"/mnt/data/0501c80a-a97b-439e-9ba4-8bd93ecc9992.png",
  type:"gif",
  caption:"Rangers clinch playoff spot at MSG",
  time:Date.now()
},
{
  user:"NHL Report",
  media:"https://media.giphy.com/media/3o6ZtaO9BZHcOjmErm/giphy.gif",
  type:"gif",
  caption:"Breaking NHL trade deadline news",
  time:Date.now()
}
];

// Load saved
let saved = JSON.parse(localStorage.getItem("stories")||"[]");
stories = stories.concat(saved);

// Remove old (24h)
stories = stories.filter(s=>Date.now()-s.time < 86400000);

let current=0;
let timer;

const bar=document.getElementById("storyBar");
const viewer=document.getElementById("viewer");
const media=document.getElementById("storyMedia");
const caption=document.getElementById("caption");
const progress=document.getElementById("progress");

function renderBar(){
  bar.innerHTML="";
  stories.forEach((s,i)=>{
    let img=document.createElement("img");
    img.src=s.media;
    img.className="storyIcon";
    img.onclick=()=>openStory(i);
    bar.appendChild(img);
  });
}

function openStory(i){
  current=i;
  viewer.style.display="flex";
  showStory();
}

function showStory(){
  clearInterval(timer);
  let s=stories[current];

  if(s.type==="video"){
    let v=document.createElement("video");
    v.src=s.media;
    v.autoplay=true;
    v.loop=true;
    v.muted=true;
    v.id="storyMedia";
    v.style.width="100%";
    v.style.height="100%";
    v.style.objectFit="cover";
    media.replaceWith(v);
    media=v;
  } else {
    let img=document.createElement("img");
    img.src=s.media;
    img.id="storyMedia";
    img.style.width="100%";
    img.style.height="100%";
    img.style.objectFit="cover";
    media.replaceWith(img);
    media=img;
  }

  caption.innerText=s.caption;
  progress.style.width="0%";

  let p=0;
  timer=setInterval(()=>{
    p+=1;
    progress.style.width=p+"%";
    if(p>=100){
      nextStory();
    }
  },40); // smooth
}

function nextStory(){
  clearInterval(timer);
  current++;
  if(current>=stories.length){
    closeViewer();
  } else{
    showStory();
  }
}

function closeViewer(){
  viewer.style.display="none";
  clearInterval(timer);
}

// Upload
function addStory(){
  let file=document.getElementById("fileInput").files[0];
  let text=document.getElementById("captionInput").value;

  if(!file)return alert("Select a file");

  let url=URL.createObjectURL(file);
  let type=file.type.startsWith("video")?"video":"image";

  let obj={
    user:"You",
    media:url,
    type:type,
    caption:text,
    time:Date.now()
  };

  stories.unshift(obj);

  let saved=JSON.parse(localStorage.getItem("stories")||"[]");
  saved.unshift(obj);
  localStorage.setItem("stories",JSON.stringify(saved));

  renderBar();
  document.getElementById("fileInput").value="";
  document.getElementById("captionInput").value="";
}

// Close
closeBtn.onclick=closeViewer;
viewer.onclick=e=>{
  if(e.target===viewer)closeViewer();
}

renderBar();

</script>
</body>
</html>
